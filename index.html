<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Hinário Ubuntu</title>
<style>
body {
  font-family: serif;
  background:#111;
  color:#fff;
  margin:0;
  padding:20px;
}
.hymn {
  cursor:pointer;
  padding:12px;
  border-bottom:1px solid #333;
}
.hymn:hover {
  background:#222;
}
.overlay {
  display:none;
  position:fixed;
  inset:0;
  background:rgba(0,0,0,0.85);
}
.overlay.active {
  display:block;
}
.content {
  background:#222;
  margin:5%;
  padding:20px;
}
button {
  padding:8px 12px;
}
audio {
  width:100%;
  margin-top:15px;
}
</style>
</head>
<body>

<h1>Hinário Ubuntu</h1>
<div id="list">Carregando hinos…</div>

<div id="overlay" class="overlay">
  <div class="content">
    <button onclick="closeDetail()">Fechar</button>
    <h2 id="title"></h2>
    <pre id="lyrics"></pre>
    <div id="audio"></div>
  </div>
</div>

<script>
const CSV_URL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vRMmvd1DczfnoyH1TzT0eqjCoSw1dkYXMKKcpO5_NbfHJ-d3bDQjlLOJtBk_EwKsiXoq3gGqUC854KC/pub?gid=0&single=true&output=csv';

function parseCSV(text){
  const lines = text.split(/\r?\n/).slice(1);
  return lines.map(l=>{
    const p = l.split(',');
    return {
      num: p[0],
      title: p[1],
      lyrics: p[2],
      audio: (p[3]||'').trim()
    };
  }).filter(h=>h.num && h.title);
}

fetch(CSV_URL)
  .then(r=>r.text())
  .then(t=>{
    const data = parseCSV(t);
    const list = document.getElementById('list');
    list.innerHTML='';
    data.forEach(h=>{
      const d = document.createElement('div');
      d.className='hymn';
      d.textContent = h.num + ' - ' + h.title;
      d.onclick = ()=>showDetail(h);
      list.appendChild(d);
    });
  })
  .catch(()=>{
    document.getElementById('list').textContent='Erro ao carregar a planilha.';
  });

function showDetail(h){
  document.getElementById('title').textContent = h.title;
  document.getElementById('lyrics').textContent = h.lyrics || 'Letra não disponível';
  const a = document.getElementById('audio');
  if(h.audio){
    a.innerHTML = '<audio controls><source src="'+h.audio+'"></audio>';
  } else {
    a.textContent = 'Áudio não disponível';
  }
  document.getElementById('overlay').classList.add('active');
}

function closeDetail(){
  document.getElementById('overlay').classList.remove('active');
  document.getElementById('audio').innerHTML='';
}
</script>

</body>
</html>
